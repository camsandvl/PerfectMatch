<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Resultados</title>
    <link rel="stylesheet" href="/results.css">
</head>
<body>
    <header><h1>Perfect Match</h1></header>
    <h1>Productos recomendados</h1>


    <div class="success-message">
    <p>¡Encontramos los productos perfectos para ti!</p>
    </div>


    <ul>
        <li th:each="producto : ${productos}">
            <img th:src="${producto.imagenUrl}" alt="Imagen de producto" style="width: 150px; height: auto;">
            <strong th:text="${producto.nombre}"></strong> -
            <span th:text="${producto.marca}"></span> -
            <span th:text="${producto.descripcion}"></span> -
            <span th:text="'Q' + ${producto.precio}"></span>
        </li>
    </ul>
    <a href="/dashboard" class="btn">Volver al inicio!</a>

    <div id="similares-corrector" class="similares-section">
      <h2>También te puede interesar (Corrector)</h2>
      <ul id="similares-corrector-list"></ul>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
    const usuario = localStorage.getItem('usuario');
    if (!usuario) return;
      fetch('/api/recomendar/concelear?usuario=' + encodeURIComponent(usuario))
        .then(res => res.json())
        .then(similar => {
          const cont = document.getElementById('similares-corrector-list');
          if (!similar || !similar.nombre) {
            cont.innerHTML = '<li style="color:#e75480;">No hay productos similares para recomendar.</li>';
            return;
          }
          cont.innerHTML = `
            <li>
              <strong>${similar.nombre}</strong>
              ${similar.marca ? ' - ' + similar.marca : ''}
              ${similar.descripcion ? ' - ' + similar.descripcion : ''}
              ${similar.precio ? ' - Q' + similar.precio : ''}
            </li>
          `;
        });
    });
    </script>

</body>
</html>
